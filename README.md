# MDRobot
Design files for Metal Detecting Robot

The MD Detecting Robot is a design platform that is designed to tow a metal detector coil array behind the main body.  This will allow the coil to not detect off the metal of the robot itself.  The robot will autonomously "scan" a field, much like a lawnmower.  Various patterns should be possible such as back and forth, or circular spiral patterns.

The Robot has several major components in the overall system, with space designed in to add several more if needed. 

The first major component is the power distribution system.  The robot is powered from dual 12V, 35ah batteries with a 600W sinewave inverter.  The battery's directly power the motor amplifier board, a dual 2X25 Sabertooth amplifier.  The inverter powers the controls, which include 5V for the various SBC boards such as the Raspberry Pis, the 12V which powers the WIFI router, 24V which powers the contactors and brakes, and +/- 15V which powers the current sensors and metal detector circuitry.

The second major component is the main on-board supervisory controller.  The supervisory controller is powered by a Raspberry Pi running an industrial softPLC software runtime from Codesys.  The Pi interfaces to a baseboard interfaced via I2C which houses a Teensy 3.1 microcontroller, a 10 DOF IMU from Adafruit, and a 4ch I2C based DAC.  The Teensy drives the 4 solid state relays, and has 4 A/D channels utilized with buffering provided on the base board.  The solid state relays drive the ESTOP circuit and the brakes on the robot.  The 4ch DAC drives the dual analog-controlled Sabertooth amplifier.  The Pi also uses a Pi Camera to provide streaming video embedded in the web browser GUI.  The web broswer GUI can be controlled remotely from additional computers on the network, and can be recorded using standard desktop recording software such as FRAPS or Camtasia.

The third component is the positioning measuring system, which is comprised of several pieces.  The robot's GPS coordinates are provided by an Adafruit Ultimate GPS Hat board.  In addition to this, the robot wheels have encoders that can keep limited track of positioning through dead reckoning.  A beacon system, located at four corners of the area to be scanned, provide triangulation of the robot as well.  Each beacon houses a Pi with a GPS hat, and are linked to the robot's Wifi network.  Each beacon runs a Modbus server, and the main supervisory Pi polls these servers through it's Modbus client.  With the five GPS readings, the IMU, and the wheel encoder feedback, hopefully an accurate reading can be derived of position in the scan area.

The fourth component is the metal detecting subsystem, which is comprised of detection circuits, a large pulse induction coil, and smaller coils, mounted to a PVC frame, which can be lifted up or down, to facilitate turning or other obstacle related issues.  The frame is mounted to a PVC pipe arm which is lifted by the action a linear actuator, also controlled from the controller Pi.  The metal detector will use multiple, pulse induction detection circuits, controlled from a master controller, each circuit tuned to the particular coil.  Each coil will be actuated in sequence, to prevent interference with other coils.  This master controller will provide all of the detection feedback to the robot's supervisor controller over a Wifi interface.

Detections from the MD subsystem, will be logged with the dereived GPS coordinates, along with the dead-reckoning and beacon-derived world coordinates.  A color map can be generated from this data, but initially data will be recorded with a waterfall-style recording, similar to that of other scanning systems.  By timestamping the waterfall recording, a metadata file can be generated with all of the other data using the same timestamp.  

Finally, the operator will have several points of control for the system.  A small hand pendant will be used for basic positioning and driving tasks.  This pendant will utilize an ESP8266 Wifi processor based board such as the Adafruit Huzzah coupled with e Teensy 3.1, or similar.  A dual axis Joystick along with several buttons, and a LCD readout will provide basic control, as well as the ability to remotely ESTOP the robot in case of emergency.  The main operator control console will be comprised of a laptop, running Windows 10 with an Azure based GUI.  A SQL Server will be running and will be used for historian data keeping.  The Azure GUI will interface to the supervisory Pi via Modbus TCP.  This laptop may eventually be located onto the robot itself, and become a high level interface computer for a Kinect sensor, and other USB-based sensors, such as Phidgets.  The controller GUI would be accessible via VNC at this point to a smaller, cheaper operator laptop.

All of the necessary design files for the system, will be available in this repository, including source code, board design files, BOMS, schematics, and other relevant information.
